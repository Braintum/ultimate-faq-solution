(()=>{"use strict";var e={n:l=>{var t=l&&l.__esModule?()=>l.default:()=>l;return e.d(t,{a:t}),t},d:(l,t)=>{for(var a in t)e.o(t,a)&&!e.o(l,a)&&Object.defineProperty(l,a,{enumerable:!0,get:t[a]})},o:(e,l)=>Object.prototype.hasOwnProperty.call(e,l)};const l=window.wp.blocks,t=window.wp.data,a=window.wp.element,o=window.wp.components,s=window.wp.blockEditor,r=window.wp.i18n,i=window.wp.apiFetch;var n=e.n(i);const c=window.ReactJSXRuntime;(0,l.registerBlockType)("ultimate-faq-solution/block",{title:"FAQ",icon:"editor-help",category:"widgets",attributes:{group:{type:"string",default:""},exclude:{type:"array",default:[]},behaviour:{type:"string",default:[]},elements_order:{type:"string",default:[]},hideTitle:{type:"boolean",default:!1}},edit({attributes:e,setAttributes:l,isSelected:i,context:d}){const[u,h]=(0,a.useState)([]),[p,w]=(0,a.useState)(""),[f,g]=(0,a.useState)(!1);(0,a.useEffect)((()=>{n()({path:"/wp/v2/ufaqsw?per_page=100"}).then((e=>{h(e)}))}),[]),(0,a.useEffect)((()=>{if(e.group){g(!0);const l=`/ufaqsw-preview/?${new URLSearchParams({group:e.group,exclude:e.exclude.join(","),behaviour:e.behaviour||"",elements_order:e.elements_order||"",hideTitle:e.hideTitle?"1":"0"}).toString()}`;w(l),g(!1)}else w(""),g(!1)}),[e.group,e.exclude,e.behaviour,e.elements_order,e.hideTitle]);const _=(0,t.useSelect)((e=>[{label:(0,r.__)("Choose a behaviour","ufaqsw"),value:""},{label:(0,r.__)("Accordion","ufaqsw"),value:"accordion"},{label:(0,r.__)("Toggle","ufaqsw"),value:"toggle"}]),[]),v=(0,t.useSelect)((e=>[{label:(0,r.__)("Choose an order","ufaqsw"),value:""},{label:(0,r.__)("ASC","ufaqsw"),value:"asc"},{label:(0,r.__)("DESC","ufaqsw"),value:"desc"}]),[]),m=function(){if(!e.group)return"";let l="[ ";return"all"===e.group?(l+="ufaqsw-all ",e.exclude.length>0&&(l+='exclude="'+e.exclude.join(",")+'" '),e.behaviour.length>0&&(l+='behaviour="'+e.behaviour+'" ')):l+='ufaqsw id="'+e.group+'" ',e.elements_order.length>0&&(l+='elements_order="'+e.elements_order+'" '),e.hideTitle&&(l+='title_hide="1" '),l+="]",l};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.InspectorControls,{children:(0,c.jsxs)(o.PanelBody,{title:(0,r.__)("FAQ Settings","ufaqsw"),children:[(0,c.jsx)(o.SelectControl,{label:(0,r.__)("Select FAQ Group","ufaqsw"),help:(0,r.__)("Choose a group to display FAQs from.","ufaqsw"),value:e.group,options:u?[{label:(0,r.__)("Select a FAQ group","ufaqsw"),value:""},{label:(0,r.__)("All","ufaqsw"),value:"all"}].concat(u.map((e=>({label:e.title,value:e.id})))):[{label:(0,r.__)("Loading...","ufaqsw"),value:""}],onChange:e=>l({group:e})}),(0,c.jsx)(o.CheckboxControl,{label:(0,r.__)("Hide group title","ufaqsw"),help:(0,r.__)("Check to hide the group title. This will override the faq group setting.","ufaqsw"),checked:e.hideTitle,onChange:e=>l({hideTitle:e})}),"all"===e.group&&(0,c.jsx)(o.SelectControl,{label:"Behaviour",help:"Choose a behaviour for the FAQ display. This will override the faq group settings.",value:e.behaviour,options:_,onChange:e=>l({behaviour:e})}),(0,c.jsx)(o.SelectControl,{label:"Order",value:e.elements_order,options:v,onChange:e=>l({elements_order:e})}),"all"===e.group&&(0,c.jsx)(o.PanelBody,{title:"Exclude Individual FAQ Groups",children:u&&u.map((t=>(0,c.jsx)(o.CheckboxControl,{label:t.title,checked:e.exclude.includes(t.id),onChange:a=>{const o=a?[...e.exclude,t.id]:e.exclude.filter((e=>e!==t.id));l({exclude:o})}},t.id)))})]})}),e.group?(0,c.jsxs)("div",{className:"ufaqsw-block-wrapper",children:[i&&(0,c.jsx)("div",{className:"ufaqsw-block-controls",children:(0,c.jsxs)("div",{className:"ufaqsw-shortcode-display",children:[(0,c.jsx)("label",{children:(0,r.__)("Generated Shortcode:","ufaqsw")}),(0,c.jsx)("code",{children:m()})]})}),f?(0,c.jsxs)("div",{className:"ufaqsw-loading",children:[(0,c.jsx)(o.Spinner,{}),(0,c.jsx)("span",{children:(0,r.__)("Loading FAQ content...","ufaqsw")})]}):(0,c.jsxs)("div",{className:"ufaqsw-iframe-container",children:[(0,c.jsx)("iframe",{src:p,className:"ufaqsw-content-preview-iframe",title:(0,r.__)("FAQ Preview","ufaqsw"),frameBorder:"0",width:"100%",height:"400",onLoad:()=>{const e=document.querySelector(".ufaqsw-content-preview-iframe");if(e)try{const l=e.contentDocument||e.contentWindow.document,t=Math.max(l.body.scrollHeight,300);e.style.height=t+"px"}catch(l){e.style.height="400px"}}}),!i&&(0,c.jsx)("div",{className:"ufaqsw-iframe-overlay"})]})]}):(0,c.jsxs)("div",{className:"components-placeholder is-large",children:[(0,c.jsxs)("div",{className:"components-placeholder__label",children:[(0,c.jsx)("span",{className:"faq-block-icon dashicons dashicons-editor-help",role:"img","aria-label":"FAQ Icon"})," FAQ Block"]}),(0,c.jsx)("div",{className:"components-placeholder__instructions",children:"Configure the block from right panel - FAQ Settings"}),(0,c.jsxs)("div",{className:"components-placeholder__fieldset",children:[(0,c.jsx)("label",{children:"Generated Shortcode"}),(0,c.jsx)("input",{className:"components-text-control__input",type:"text",disabled:!0,value:m()})]})]})]})},save:()=>null})})();